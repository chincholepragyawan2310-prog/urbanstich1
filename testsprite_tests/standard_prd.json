{
  "meta": {
    "project": "UrbanStich",
    "date": "2025-11-14",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "UrbanStich is a web-based e-commerce platform specializing in men’s fashion. The product allows users to browse and filter fashion items, manage carts, place orders with online payment or cash on delivery, and view their order history. Admin users can manage products and orders. The platform uses a Node.js backend with Express, a simple frontend with HTML and Tailwind CSS, and integrates Razorpay for payment processing.",
  "core_goals": [
    "Enable users to browse, filter, and view a catalog of men’s fashion products.",
    "Provide seamless user registration, login, and authentication.",
    "Allow users to manage a shopping cart with adds, updates, and deletions of items.",
    "Support placing orders with secure payment via Razorpay or cash on delivery options.",
    "Enable users to view their previous orders with detailed status.",
    "Offer admins the capability to add, update, delete products, and manage orders and inventory.",
    "Ensure a responsive and error-resilient UI with protected admin routes and smooth client-server interaction."
  ],
  "key_features": [
    "Product catalog with category filtering (t-shirts, shirts, jeans, jackets).",
    "User authentication: register, login, and secure password handling.",
    "Cart management: add, update quantity, remove items, and automatic total recalculation.",
    "Order placement: create orders from cart items with validation for empty or invalid carts.",
    "Payment integration with Razorpay: create payment orders, verify signatures, and update payment statuses.",
    "Cash on Delivery (COD) order confirmation option.",
    "User order history retrieval and display.",
    "Newsletter email subscription feature.",
    "Admin functions for product CRUD operations and order status management (described in the specification).",
    "Legacy checkout API supported for backward compatibility."
  ],
  "user_flow_summary": [
    "Visitor accesses product catalog and uses filters to narrow product selection by category.",
    "User registers a new account or logs in to access personalized features.",
    "Authenticated user adds desired products with selected sizes and quantities to the cart.",
    "User reviews cart contents and proceeds to checkout page.",
    "User selects payment method: Razorpay online payment or Cash on Delivery.",
    "For Razorpay payments, system creates a Razorpay order and, upon payment completion, verifies the transaction before confirming the order.",
    "For COD, user confirms the order which updates the status accordingly.",
    "User can view their order history and status updates anytime.",
    "Newsletter subscription is available on the homepage for users to submit their email for updates."
  ],
  "validation_criteria": [
    "Product APIs return correct products with optional category filtering.",
    "User registration validates required fields and unique email enforcement; returns authentication token.",
    "User login validates credentials and returns user info with token on success.",
    "Cart operations correctly update item quantities and totals and handle invalid or empty inputs gracefully.",
    "Order creation API enforces non-empty carts and valid products; returns new order identifiers and totals.",
    "Razorpay integration APIs create orders and verify payments correctly handling missing or invalid data.",
    "COD order confirmation properly updates order status and prevents re-processing.",
    "User order retrieval returns only authenticated user’s orders with appropriate access controls.",
    "Newsletter subscription endpoint validates email format and stores subscription correctly.",
    "Admin routes are secured with proper role checks and support product and order management functionalities.",
    "UI behaves responsively, errors are handled gracefully, and admin sections are accessible only to authorized users."
  ],
  "code_summary": {
    "tech_stack": [
      "JavaScript",
      "Node.js",
      "Express",
      "HTML",
      "CSS",
      "Tailwind CSS",
      "Razorpay",
      "In-memory storage"
    ],
    "features": [
      {
        "name": "Get Products",
        "description": "Retrieve all products or filter by category (t-shirts, shirts, jeans, jackets)",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Get Products API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/products": {
              "get": {
                "summary": "Get all products or filter by category",
                "parameters": [
                  {
                    "name": "category",
                    "in": "query",
                    "schema": {
                      "type": "string",
                      "enum": [
                        "t-shirts",
                        "shirts",
                        "jeans",
                        "jackets"
                      ]
                    },
                    "required": false,
                    "description": "Filter products by category"
                  }
                ],
                "responses": {
                  "200": {
                    "description": "List of products",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "products": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "id": {
                                    "type": "string"
                                  },
                                  "title": {
                                    "type": "string"
                                  },
                                  "price": {
                                    "type": "number"
                                  },
                                  "image": {
                                    "type": "string"
                                  },
                                  "category": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "User Registration",
        "description": "Register a new user account with name, email, and password",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/auth.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "User Registration API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/auth/register": {
              "post": {
                "summary": "Register a new user",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "name",
                          "email",
                          "password"
                        ],
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "email": {
                            "type": "string",
                            "format": "email"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Registration successful",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "token": {
                              "type": "string"
                            },
                            "user": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "email": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Bad request - missing fields or email already registered"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "User Login",
        "description": "Authenticate user with email and password",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/auth.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "User Login API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/auth/login": {
              "post": {
                "summary": "Login user",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "email",
                          "password"
                        ],
                        "properties": {
                          "email": {
                            "type": "string",
                            "format": "email"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Login successful",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "token": {
                              "type": "string"
                            },
                            "user": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "email": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Invalid credentials"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Get User Orders",
        "description": "Retrieve all orders for the authenticated user",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Get User Orders API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/orders": {
              "get": {
                "summary": "Get user orders",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "responses": {
                  "200": {
                    "description": "List of user orders",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "orders": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Create Order",
        "description": "Create a new order with cart items",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/cart.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Create Order API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/orders": {
              "post": {
                "summary": "Create a new order",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "items"
                        ],
                        "properties": {
                          "items": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "productId": {
                                  "type": "string"
                                },
                                "quantity": {
                                  "type": "number"
                                },
                                "size": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Order created successfully",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "orderId": {
                              "type": "string"
                            },
                            "total": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Bad request - empty cart or invalid products"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Create Razorpay Order",
        "description": "Create a Razorpay payment order for online payment",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/payment.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Create Razorpay Order API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/payment/create-razorpay-order": {
              "post": {
                "summary": "Create Razorpay payment order",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "orderId"
                        ],
                        "properties": {
                          "orderId": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Razorpay order created",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "amount": {
                              "type": "number"
                            },
                            "currency": {
                              "type": "string"
                            },
                            "razorpayOrderId": {
                              "type": "string"
                            },
                            "orderId": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Bad request - order ID missing or order already processed"
                  },
                  "404": {
                    "description": "Order not found"
                  },
                  "500": {
                    "description": "Razorpay credentials not configured or creation failed"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Verify Payment",
        "description": "Verify Razorpay payment signature and update order status",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/payment.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Verify Payment API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/payment/verify": {
              "post": {
                "summary": "Verify Razorpay payment",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "orderId",
                          "razorpay_order_id",
                          "razorpay_payment_id",
                          "razorpay_signature"
                        ],
                        "properties": {
                          "orderId": {
                            "type": "string"
                          },
                          "razorpay_order_id": {
                            "type": "string"
                          },
                          "razorpay_payment_id": {
                            "type": "string"
                          },
                          "razorpay_signature": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Payment verified successfully",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "message": {
                              "type": "string"
                            },
                            "orderId": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Bad request - missing data or invalid signature"
                  },
                  "404": {
                    "description": "Order not found"
                  },
                  "500": {
                    "description": "Razorpay secret not configured"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Confirm COD Order",
        "description": "Confirm a Cash on Delivery order",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/assets/js/payment.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Confirm COD Order API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/orders/{id}/cod-confirm": {
              "post": {
                "summary": "Confirm COD order",
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    },
                    "description": "Order ID"
                  }
                ],
                "responses": {
                  "200": {
                    "description": "COD order confirmed",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "message": {
                              "type": "string"
                            },
                            "orderId": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Order already processed"
                  },
                  "404": {
                    "description": "Order not found"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Newsletter Subscription",
        "description": "Subscribe email to newsletter",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js",
          "urbanstich/frontend/index.html"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Newsletter Subscription API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/newsletter/subscribe": {
              "post": {
                "summary": "Subscribe to newsletter",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "email"
                        ],
                        "properties": {
                          "email": {
                            "type": "string",
                            "format": "email"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Subscription successful",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "ok": {
                              "type": "boolean"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Email required"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Legacy Checkout",
        "description": "Legacy checkout endpoint for backward compatibility",
        "files": [
          "urbanstich/backend/server.js",
          "urbanstich/frontend/assets/js/api.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Legacy Checkout API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/checkout": {
              "post": {
                "summary": "Legacy checkout endpoint",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "items"
                        ],
                        "properties": {
                          "items": {
                            "type": "array",
                            "items": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Checkout successful",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "orderId": {
                              "type": "string"
                            },
                            "total": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Empty cart"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
